import Page from "@reason/pages/Docs";
import DocLink from "@reason/components/DocLink";
export default Page({ title: "Hot / Cold Block Production" });

# Горячее / холодное создание блоков

Производство блоков - это сложный процесс, который требует наличие ноды для подключения к сети интернет. Кошелек называется «горячим», если закрытый ключ доступен на устройстве, подключенном к сети интернет. Более предусмотрительные блок-продюсеры могут захотеть избежать использования горячих кошельков со значительными суммами средств на них, чтобы снизить риск в случае хакерской атаки на их систему.

Кошелек называется "холодным", если закрытый ключ не доступен и никогда ранее не был доступен в сети интернет. Холодное хранение предпочтительнее для кошельков, содержащих значительные суммы, поскольку такие системы сложнее взломать, так как они никогда не подсоединялись к интернет-сети. Это так же просто, как создать пару ключей на ноутбуке с отключенным интернетом или использовать аппаратный кошелек, такой, как, [например, устройство Ledger](https://shop.ledger.com/).

Протокол Mina требует от блок-продюсеров использования горячего кошелька (смотрите почему так в последнем разделе этой статьи) -- однако, существуют механизмы, позволяющие предусмотрительным блок-продюсерам хранить большую часть своих средств на холодном кошельке. Произведенные блоки и все связанные с ними доходы возникают посредством делегирования с этого холодного кошелька на горячий.

В следующей части статьи описаны действия, необходимые для эффективного создания блоков, когда большая часть ваших средств попадает на холодный кошелек и остается там.

## Предпосылки

Перед запуском блок-продюсера вам понадобятся как минимум два аккаунта: один холодный кошелек и один горячий кошелек.

### Создание горячего кошелька

Посмотрите страницу нашей документации по <DocLink copy="генерации ключей" url="/node-operators/keypair" />. Обратите внимание, что, поскольку это горячий кошелек, вам не следует использовать ledger или любые другие HSM для этой пары ключей.

Запишите свой горячий открытый ключ.

### Положите на свой горячий кошелек некоторое количество токенов

Прежде чем использовать горячий кошелек, он должен попасть в главную книгу консенсуса. Если адрес вашего горячего кошелька присутствует в Genesis-книге, никаких дальнейших действий не требуется. Если это не так, вам необходимо будет приобрести некоторое количество токенов mina, необходимое для платы за создание аккаунта, и отправить эти токены на этот открытый ключ.

### Создание холодного кошелька

Посмотрите страницу нашей документации по <DocLink copy="генерации ключей" url="/node-operators/keypair" />. Обратите внимание, что так как это холодный кошелек, вы должны использовать наиболее безопасный механизм для генерации ключей, который выполняется на неподключенном к сети интернет устройстве.

### Настройка холодного кошелька

Ваш холодный кошелек должен присутствовать в главной книге консенсуса, прежде чем его баланс может быть подсчитан при передаче на ваш горячий кошелек. Если адрес вашего холодного кошелька присутствует в Genesis-книге, дальнейшие действия не требуются. В противном случае приобретите достаточное количество токенов для значимого участия в консенсусе и отправьте их на этот адрес холодного кошелька.

### Делегирование с холодного на горячий кошелек

Теперь вам этого необходимо убедиться, что вы делегировали средства с холодного на горячий кошелек. Если вы настроили свой аккаунт для делегирования на корректный адрес в genesis-книге, дальнейшие действия не требуются. В противном случае вы можете делегировать с помощью команды `mina client delegate-stack`, если ваш ключ был сгенерирован на компьютере. Если это не так, смотрите инструкции по делегированию в [Mina ledger README](https://github.com/jspada/ledger-app-mina/tree/v1.0.0-beta.2), чтобы узнать больше.

## Создание блоков

Следуйте инструкциям по "Запуску ноды" на странице <DocLink copy="Подключение к сети" url="/connecting" />, используя ключ горячего кошелька.

## Детали протокола

Вы можете подумать: почему я не могу создавать блоки непосредственно из безопасного анклава или другого HSM-устройства в протоколе Mina?

Два компонента создания блоков требуют использования закрытого ключа необычными способами: выигрыш слота и создание блокчейн-снарков. Создание снарков на защищенном оборудовании чрезвычайно сложно и, вероятно, не может производиться достаточно быстро для нашего протокола с учетом сегодняшних технологий.

### Выигрыш слота (из снарка)

Блок-продюсер может определить, выиграл ли он слот, оценив VRF (или проверяемую случайную функцию), используя свой закрытый ключ. VRF необходимо оценить для вашего аккаунта и всех аккаунтов, которые вам делегируют, для всех слотов в течение эпохи. Насколько нам известно, никто никогда не реализовывал VRF на HSM, но, скорее всего, это не так сложно.

### Создание блокчейн-снарка

Когда блок-продюсер выигрывает слот, помимо создания и трансляции блока в сеть, он должен создать новое SNARK-доказательство, которое потдверждает действительность всего блокчейна, включая этот новый блок. SNARK-доказательство использует закрытый ключ при внесении информации о VRF в доказательство. Это доказательство заменяет простую цифровую подпись, которую другие протоколы запрашивают у своих валидаторов. Создание этого SNARK-доказательства очень затратно с точки зрения вычислительных ресурсов и основано на продвинутых криптографических алгоритмах. Ни один HSM на рынке не способен создать это SNARK-доказательство достаточно эффективно, даже если будет потрачено время на реализацию алгоритма SNARK-доказательства.
