import Page from '@reason/pages/Docs';
import DocLink from "@reason/components/DocLink";
export default Page({title: "Foundation Delegation Program"});

# Рекомендации по участию в программе делегирования Mina Foundation

Ознакомьтесь с [политикой делегирования Foundation](https://minaprotocol.com/blog/mina-foundation-delegation-policy). В документе содержится подробная информация о том, что нужно сделать, чтобы выплатить вознаграждение, если вам делегируют средства, и как отправить данные о времени непрерывной работы, чтобы получить или сохранить право на получение этих вознаграждений. 

Заполните эту [форму](), если вы хотите иметь право на делегирование в будущем. 

O(1) Labs самостоятельно применило это руководство при согласовании с Foundation.

Оно включает все детали, о которых должны знать блок-продюсеры, чтобы соответствовать требованиям и удовлетворять условиям делегирования токенов от пользователей (назовем их "поставщиками токенов"). 

## Адреса для выплат

Вы должны отправить вознаграждения, полученные в ходе вычислений, на адреса поставщиков токенов, как описано ниже. Если Foundation делегирует вам токены, то выберет два адреса из списка адресов Foundation в нижней части страницы, которые будут отображаться для вас как делегированные. Вы должны распределить вознаграждения по обоим этим адресам. Если O(1) Labs делегирует вам токены, то выберет два адреса из списка адресов O(1) Labs внизу страницы, которые будут отображаться как делегированные. Вы должны распределить вознаграждения по обоим адресам, делегировавшим вам токены.

## Частота выплат

Вознаграждения должны распределяться хотя бы один раз в течение данной эпохи (но вы можете отправлять их и чаще), все вознаграждения для эпохи N должны быть доставлены адресатам (т.е. приняты в блоке, а не просто отправлены) не позднее, чем до слота номер 3,500 следующей эпохи. У вас будет около недели на то, чтобы произвести эти платежи.

## Спецификации вознаграждений

Вы должны отправить **как минимум** сумму, указанную этим механизмом. Если вы отправите больше токенов, вы все равно останетесь правомочным участником, но не получите средства обратно.

В конце каждой эпохи сделайте следующее:

1. Вычислите общую сумму делегированных вашей учетной записью токенов за эту эпоху.
2. Вычислите долю поставщика токенов (с обеих учетных записей), разделив сумму, делегированную поставщиками токенов на общую сумму токенов, (например `provider_share = provider_delegation / total_stake`). Результат должен находиться в пределах от 0 до 1.
3. Для каждого созданного блока, который имеет ненулевое вознаграждение за блок в канонической цепочке, умножив неувеличенное coinbase-вознаграждение (равное 720 MINA при запуске Mainnet) на долю поставщика токенов, рассчитанную на предыдущем шаге, за вычетом комиссии 5%. (т.е. `payout = (provider_share * 0.95) * coinbase`)
4. Отправьте транзакцию на счета поставщика токенов с соответствующей расчетам выплатой. 

Каноническая цепь будет рассчитываться как 12 блоков за любой вершиной слота 3,500 следующей эпохи. 

Блок-продюсер может оставить себе все комиссии за транзакции или разделить их поровну между другими участниками пула. Обратите внимание, что провайдер токенов, Foundation или O(1) ожидают получить только пропорциональную долю coinbase-вознаграждений *как если бы она не была увеличенной coinbase-наградой*. Если созданный блок был с увеличенной coinbase-наградой, дополнительные вознаграждения могут быть распределены между остальными участниками пула по вашему усмотрению. Смотрите <DocLink copy="https://docs.minaprotocol.com/advanced/staking-service-guidelines" url="/advanced/staking-service-guidelines" /> для получения подробной информации об условиях и инструментах, используемых в этом подходе.

### Пример выплаты вознаграждения

Рассмотрим следующие условия:

- Аккаунт A содержит 1 миллион **заблокированных** токенов MINA
- Аккаунты B и C контролируются Mina Foundation и содержат 2 миллиона **заблокированных** MINA каждый. Оба счета делегируют токены Аккаунту A.
- Аккаунт D контролируется третьей стороной и насчитывает 1 миллион **разблокированных** MINA. Этот аккаунт также делегирует токены Аккаунту A.

В этом примере общая сумма на счету Аккаунта A, рассчитанная путем сложения балансов всех аккаунтов, составляет 6 миллионов. Заметьте, что поскольку все токены Аккаунта D разблокированы, любые полученные за блок вознаграждения, когда `winnerAccount` является Аккаунтом D, будет начислено дополнительное вознаграждение.
 
Теперь рассмотрим Эпоху 5. Доля средств Foundation составляет `4 million MINA / 6 million MINA = 0.6` или 60%. В эту эпоху создаются три блока, которые попадают в каноническую цепь. 

Первый блок имеет `winnerAccount`, соответствующий Аккаунту A. Общая выплата Foundation для этого блока рассчитывается как `(0.6 * 0.95) * 720 MINA = 410.4 MINA`. Во втором блоке `winnerAccount` является Аккаунт В - общая выплата Foundation снова рассчитывается как `(0.6 * 0.95) * 720 MINA = 410.4 MINA`. В третьем и последнем блоке `winnerAccount` является Аккаунт D. Теперь coinbase-вознаграждение для этого блока увеличено и составит 1440 MINA, но, несмотря на это, вознаграждения Foundation по-прежнему равны `410.4 MINA`, поскольку они рассчитываются с использованием неувеличенного coinbase-вознаграждения. Таким образом, общая сумма выплат Foundation со всех блоков составит `410.4 MINA * 3 blocks = 1,231.2 MINA`.

Наконец, перед слотом 3,500 следующей эпохи с любого аккаунта, которым управляет этот блок-продюсер, производятся два платежа на каждый из аккаунтов Foundation - в случае, если платеж поступает с учетной записи, отличной от Аккаунта A, которому делегируют токены, пожалуйста, укажите идентификатор Discord, который регистрируется программой, в поле платежа `memo`. Каждый платеж составляет `1231.2 MINA / 2 = 615.6 MINA` токенов. Обратите внимание, что комиссии за две эти транзакции оплачиваются продюсером блоков.

Поставщик токенов, Foundation либо O(1) Labs соответственно, проверят, что вы произвели платежи с помощью этого механизма к середине следующей эпохи, как описано выше. Невыполнение этого требования может привести к потере права получать делегированные токены.

## Как избежать проблем с округлением

Если вы рассчитали вознаграждение, которое имеет нечетное количество nonomina, и вам нужно разделить его между двумя счетами, можно округлить в меньшую сторону и оставить себе 1 лишнюю  nanomina.

## Установка и запуск аптайм sidecar

При участии в Программе делегирования Foundation вам также потребуется запустить сопутствующий аптайм-компонент, поэтому, пожалуйста, следуйте <DocLink copy="этим инструкциям" url="/advanced/bp-sidecar" /> для его настройки совместно с daemon вашего блок-продюсера.

## Адреса для поставщиков токенов

* [Mina Foundation](/static/Mina_Foundation_Addresses.csv)

* [O(1) Labs](/static/O1_Labs_addresses.csv)

